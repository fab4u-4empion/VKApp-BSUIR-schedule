(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[5],{173:function(e,t,r){"use strict";r.r(t);var c=r(142),s=r(0),n=r(11),a=r(168),i=r(170),o=r(171),l=r(165),u=r(166),j=r(167),d=r(169),h=r(143),b=r.n(h),O=r(13),f=r.n(O),g=r(9);var p=function(e){var t=Object(s.useState)(new AbortController),r=Object(c.a)(t,1)[0],i=Object(s.useState)(history.state.searchValue),o=Object(c.a)(i,2),h=o[0],O=o[1],p=Object(s.useState)(null),x=Object(c.a)(p,2),v=x[0],S=x[1],y=Object(s.useState)(!!localStorage.getItem("groups")),w=Object(c.a)(y,2),m=w[0],C=w[1],k=Object(s.useState)(!1),E=Object(c.a)(k,2),L=E[0],_=E[1],I=Object(s.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")):[]),J=Object(c.a)(I,2),N=J[0],P=J[1],V=Object(s.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(h.toLowerCase())>-1})):[]),F=Object(c.a)(V,2),T=F[0],R=F[1],A=Object(s.useState)(1),H=Object(c.a)(A,2),W=H[0],B=H[1],G=Object(s.useState)(!1),z=Object(c.a)(G,2),K=z[0],X=z[1],q=Object(s.useState)(!1),D=Object(c.a)(q,2),M=D[0],Q=D[1],U=Object(s.useState)([]),Y=Object(c.a)(U,2),Z=Y[0],$=Y[1],ee=Object(s.useState)(sessionStorage.getItem("groupsFavorite")?JSON.parse(sessionStorage.getItem("groupsFavorite")):[]),te=Object(c.a)(ee,2),re=te[0],ce=te[1];Object(s.useEffect)((function(){window.scrollTo(window.scrollX,0);var e=history.state;e.searchValue=h,history.replaceState(e,""),R(N.filter((function(e){return e.name.toLowerCase().indexOf(h.toLowerCase())>-1})))}),[h]),Object(s.useEffect)((function(){K&&T.length>30?($([].concat(Object(l.a)(Z),Object(l.a)(T.slice(30*W,30*W+30)))),B((function(e){return e+1})),X(!1)):X(!1)}),[K]),Object(s.useEffect)((function(){B(1),$(T.slice(0,30))}),[T]),Object(s.useEffect)((function(){sessionStorage.setItem("groupsFavorite",JSON.stringify(re))}),[re]),Object(s.useEffect)((function(){m||b.a.get("https://journal.bsuir.by/api/v1/groups",{signal:r.signal}).then((function(e){console.log("test"),localStorage.setItem("groups",JSON.stringify(e.data)),P(e.data),C((function(){return R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(h.toLowerCase())>-1}))),!0}))})).catch((function(){_(!0)}))}),[]),Object(s.useEffect)((function(){return window.addEventListener("scroll",ne),function(){window.removeEventListener("scroll",ne)}}),[]),Object(s.useEffect)((function(){return window.addEventListener("storageChange",se),function(){window.removeEventListener("storageChange",se)}}),[]),Object(s.useEffect)((function(){return function(){r.abort()}}),[]),Object(s.useEffect)((function(){return window.addEventListener("popstate",ie),function(){window.removeEventListener("popstate",ie)}}),[]);var se=function(e){"groups"===e.detail.key&&(P(JSON.parse(localStorage.getItem("groups"))),R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(h.toLowerCase())>-1}))))},ne=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&X(!0)},ae=function(){Q(!0),b.a.get("https://journal.bsuir.by/api/v1/groups",{signal:r.signal}).then((function(e){localStorage.setItem("groups",JSON.stringify(e.data)),P(e.data),Q((function(){return R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(h.toLowerCase())>-1}))),!1})),L&&(C(!0),_(!1))})).catch((function(){Q(!1),S(oe)}))},ie=function(){history.state&&O(history.state.searchValue)},oe=Object(g.jsx)(n.s,{onClose:function(){return S(null)},before:Object(g.jsx)(u.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"});return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(n.f,{vertical:"top",filled:"true",children:Object(g.jsx)(n.r,{readOnly:!m||M,value:h,onChange:function(e){return M?function(){}:function(e){history.state.isSearch?history.replaceState({activeStory:"groups",searchValue:e.target.value,isSearch:!0,groups_activePanel:"groups-list"},""):history.pushState({activeStory:"groups",searchValue:e.target.value,isSearch:!0,groups_activePanel:"groups-list"},""),O(e.target.value)}(e)},after:"\u041e\u0442\u043c\u0435\u043d\u0430"})}),Object(g.jsxs)(n.h,{style:{paddingTop:40},children:[!m&&!L&&Object(g.jsx)(n.n,{}),L&&Object(g.jsx)(n.p,{onRefresh:ae,isFetching:M,style:{minHeight:350},children:Object(g.jsx)(n.o,{children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"})}),m&&!L&&Object(g.jsxs)(n.p,{onRefresh:ae,isFetching:M,style:{minHeight:350},children:[Object(g.jsx)(n.j,{children:T.length>0&&Z.map((function(t){return Object(g.jsx)(n.c,{disabled:!0,before:Object(g.jsxs)(n.i,{onClick:function(){!function(e){var t=Object(l.a)(re),r=null;re.includes(e)?(t.splice(re.indexOf(e),1),r=Object(g.jsx)(n.s,{onClose:function(){return S(null)},before:Object(g.jsx)(u.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u0437 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})):(t.push(e),r=Object(g.jsx)(n.s,{onClose:function(){return S(null)},before:Object(g.jsx)(u.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0432 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})),f.a.send("VKWebAppStorageSet",{key:"groupsFavorite",value:JSON.stringify(t)}).then((function(){ce(t)})).catch((function(){S(r)}))}(t.id)},children:[re.includes(t.id)&&Object(g.jsx)(j.a,{fill:"var(--accent)"}),!re.includes(t.id)&&Object(g.jsx)(a.a,{fill:"var(--accent)"})]}),after:Object(g.jsx)(n.i,{onClick:function(){var r;r=t.name,e.onGroupSelect(r)},children:Object(g.jsx)(d.a,{fill:"var(--icon_tertiary)"})}),children:t.name},t.id)}))}),0===T.length&&Object(g.jsx)(n.g,{children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})]}),v]})]})};t.default=function(){var e=Object(n.A)().viewWidth,t=Object(n.B)(),r=e>=n.z.TABLET,l=t!==n.x,u=Object(s.useState)("favorites"),j=Object(c.a)(u,2),d=j[0],h=j[1],b=Object(s.useState)("groups-list"),O=Object(c.a)(b,2),f=O[0],x=O[1],v=Object(s.useState)(""),S=Object(c.a)(v,2),y=S[0],w=S[1];Object(s.useEffect)((function(){history.pushState({activeStory:"favorites",searchValue:"",isSearch:!1,groups_activePanel:"groups-list"},"")}),[]),Object(s.useEffect)((function(){return window.addEventListener("popstate",C),function(){window.removeEventListener("popstate",C)}}),[]);var m=function(e){history.pushState({activeStory:e.currentTarget.dataset.story,searchValue:"",isSearch:!1,groups_activePanel:"groups-list"},""),h(e.currentTarget.dataset.story)},C=function(){history.state&&(h(history.state.activeStory),x(history.state.groups_activePanel))};return Object(g.jsxs)(n.u,{header:l&&Object(g.jsx)(n.l,{separator:!1}),style:{justifyContent:"center"},children:[r&&Object(g.jsx)(n.t,{fixed:!0,width:280,maxWidth:280,children:Object(g.jsxs)(n.k,{children:[l&&Object(g.jsx)(n.l,{}),Object(g.jsxs)(n.h,{children:[Object(g.jsx)(n.c,{disabled:"favorites"===d,style:"favorites"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"favorites",onClick:m,before:Object(g.jsx)(a.a,{}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(g.jsx)(n.c,{disabled:"groups"===d,style:"groups"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"groups",onClick:m,before:Object(g.jsx)(i.a,{}),children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(g.jsx)(n.c,{disabled:"teachers"===d,style:"teachers"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"teachers",onClick:m,before:Object(g.jsx)(o.a,{}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"})]})]})}),Object(g.jsx)(n.t,{animate:!r,spaced:r,width:r?"560px":"100%",maxWidth:r?"560px":"100%",children:Object(g.jsxs)(n.e,{activeStory:d,tabbar:!r&&Object(g.jsxs)(n.v,{children:[Object(g.jsx)(n.w,{onClick:m,selected:"favorites"===d,"data-story":"favorites",text:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435",children:Object(g.jsx)(a.a,{})}),Object(g.jsx)(n.w,{onClick:m,selected:"groups"===d,"data-story":"groups",text:"\u0413\u0440\u0443\u043f\u043f\u044b",children:Object(g.jsx)(i.a,{})}),Object(g.jsx)(n.w,{onClick:m,selected:"teachers"===d,"data-story":"teachers",text:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438",children:Object(g.jsx)(o.a,{})})]}),children:[Object(g.jsx)(n.y,{id:"favorites",activePanel:"favorites-list",children:Object(g.jsxs)(n.k,{id:"favorites-list",children:[Object(g.jsx)(n.l,{children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(g.jsx)(n.h,{style:{height:"1000px"},children:Object(g.jsx)(n.o,{icon:Object(g.jsx)(a.a,{width:56,height:56}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"})})]})}),Object(g.jsxs)(n.y,{id:"groups",activePanel:f,children:[Object(g.jsxs)(n.k,{id:"groups-list",children:[Object(g.jsx)(n.l,{children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(g.jsx)(p,{onGroupSelect:function(e){history.pushState({activeStory:"groups",searchValue:"",isSearch:!1,groups_activePanel:"group-schedule"},""),w(e),x("group-schedule")}})]}),Object(g.jsxs)(n.k,{id:"group-schedule",children:[Object(g.jsx)(n.l,{left:Object(g.jsx)(n.m,{onClick:function(){return history.back()}}),children:y}),Object(g.jsx)(n.h,{style:{height:"1000px"},children:Object(g.jsxs)(n.o,{icon:Object(g.jsx)(o.a,{width:56,height:56}),children:["\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b ",y]})})]})]}),Object(g.jsx)(n.y,{id:"teachers",activePanel:"teachers-list",children:Object(g.jsxs)(n.k,{id:"teachers-list",children:[Object(g.jsx)(n.l,{children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"}),Object(g.jsx)(n.h,{style:{height:"1000px"},children:Object(g.jsx)(n.o,{icon:Object(g.jsx)(o.a,{width:56,height:56}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0435\u0442\u043b\u0438"})})]})})]})})]})}}}]);
//# sourceMappingURL=5.43212f62.chunk.js.map