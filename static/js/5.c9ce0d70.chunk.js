(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[5],{172:function(e,t,r){"use strict";r.r(t);var s=r(140),c=r(141),n=r(0),o=r(13),a=r.n(o),i=r(11),l=r(164),u=r(166),j=r(168),d=r(169),b=r(170),h=r(165),O=r(167),g=r(142),f=r.n(g),p=r(9);var x=function(e){var t=Object(n.useState)(new AbortController),r=Object(c.a)(t,1)[0],o=Object(n.useState)(history.state.searchValue),j=Object(c.a)(o,2),d=j[0],b=j[1],g=Object(n.useState)(null),x=Object(c.a)(g,2),v=x[0],S=x[1],y=Object(n.useState)(!!localStorage.getItem("groups")),m=Object(c.a)(y,2),w=m[0],C=m[1],k=Object(n.useState)(!1),_=Object(c.a)(k,2),E=_[0],I=_[1],L=Object(n.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")):[]),J=Object(c.a)(L,2),N=J[0],F=J[1],P=Object(n.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(d.toLowerCase())>-1})):[]),V=Object(c.a)(P,2),T=V[0],A=V[1],R=Object(n.useState)(history.state.groups_CurrentPage),W=Object(c.a)(R,2),q=W[0],H=W[1],B=Object(n.useState)(!1),G=Object(c.a)(B,2),K=G[0],X=G[1],z=Object(n.useState)(!1),D=Object(c.a)(z,2),M=D[0],Q=D[1],U=Object(n.useState)([]),Y=Object(c.a)(U,2),Z=Y[0],$=Y[1],ee=Object(n.useState)(sessionStorage.getItem("groupsFavorite")?JSON.parse(sessionStorage.getItem("groupsFavorite")):[]),te=Object(c.a)(ee,2),re=te[0],se=te[1];Object(n.useEffect)((function(){window.scrollTo(window.scrollX,0);var e=history.state;e.searchValue=d,history.replaceState(e,""),A(N.filter((function(e){return e.name.toLowerCase().indexOf(d.toLowerCase())>-1})))}),[d]),Object(n.useEffect)((function(){K&&T.length>30?($([].concat(Object(s.a)(Z),Object(s.a)(T.slice(30*q,30*q+30)))),H((function(e){return e+1})),X(!1)):X(!1)}),[K]),Object(n.useEffect)((function(){H(1),$(T.slice(0,30))}),[T]),Object(n.useEffect)((function(){sessionStorage.setItem("groupsFavorite",JSON.stringify(re))}),[re]),Object(n.useEffect)((function(){w||f.a.get("https://journal.bsuir.by/api/v1/groups",{signal:r.signal}).then((function(e){console.log("test"),localStorage.setItem("groups",JSON.stringify(e.data)),F(e.data),C((function(){return A(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(d.toLowerCase())>-1}))),!0}))})).catch((function(){I(!0)}))}),[]),Object(n.useEffect)((function(){return window.addEventListener("scroll",ne),function(){window.removeEventListener("scroll",ne)}}),[]),Object(n.useEffect)((function(){return window.addEventListener("storageChange",ce),function(){window.removeEventListener("storageChange",ce)}}),[]),Object(n.useEffect)((function(){return function(){r.abort()}}),[]),Object(n.useEffect)((function(){return window.addEventListener("popstate",ae),function(){window.removeEventListener("popstate",ae)}}),[]);var ce=function(e){"groups"===e.detail.key&&(F(JSON.parse(localStorage.getItem("groups"))),A(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(d.toLowerCase())>-1}))))},ne=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&X(!0)},oe=function(){Q(!0),f.a.get("https://journal.bsuir.by/api/v1/groups",{signal:r.signal}).then((function(e){localStorage.setItem("groups",JSON.stringify(e.data)),F(e.data),Q((function(){return A(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(d.toLowerCase())>-1}))),!1})),E&&(C(!0),I(!1))})).catch((function(){Q(!1),S(ie)}))},ae=function(){history.state&&b(history.state.searchValue)},ie=Object(p.jsx)(i.u,{onClose:function(){return S(null)},before:Object(p.jsx)(l.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"});return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(i.f,{vertical:"top",filled:"true",children:Object(p.jsx)(i.t,{readOnly:!w||M,value:d,onChange:function(e){return M?function(){}:function(e){history.state.isSearch?history.replaceState({activeStory:"groups",searchValue:e.target.value,isSearch:!0,groups_activePanel:"groups-list",groups_contextOpened:!1},""):history.pushState({activeStory:"groups",searchValue:e.target.value,isSearch:!0,groups_activePanel:"groups-list",groups_contextOpened:!1},""),b(e.target.value)}(e)},after:"\u041e\u0442\u043c\u0435\u043d\u0430"})}),Object(p.jsxs)(i.h,{style:{paddingTop:40},children:[!w&&!E&&Object(p.jsx)(i.p,{}),E&&Object(p.jsx)(i.r,{onRefresh:oe,isFetching:M,style:{minHeight:350},children:Object(p.jsx)(i.q,{children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"})}),w&&!E&&Object(p.jsxs)(i.r,{onRefresh:oe,isFetching:M,style:{minHeight:350},children:[Object(p.jsx)(i.j,{children:T.length>0&&Z.map((function(t){return Object(p.jsx)(i.c,{disabled:!0,before:Object(p.jsxs)(i.i,{onClick:function(){!function(e){var t=Object(s.a)(re),r=null;re.includes(e)?(t.splice(re.indexOf(e),1),r=Object(p.jsx)(i.u,{onClose:function(){return S(null)},before:Object(p.jsx)(l.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u0437 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})):(t.push(e),r=Object(p.jsx)(i.u,{onClose:function(){return S(null)},before:Object(p.jsx)(l.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0432 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})),a.a.send("VKWebAppStorageSet",{key:"groupsFavorite",value:JSON.stringify(t)}).then((function(){se(t)})).catch((function(){S(r)}))}(t.name)},children:[re.includes(t.name)&&Object(p.jsx)(h.a,{fill:"var(--accent)"}),!re.includes(t.name)&&Object(p.jsx)(u.a,{fill:"var(--accent)"})]}),after:Object(p.jsx)(i.i,{onClick:function(){var r;r=t.name,e.onGroupSelect(r)},children:Object(p.jsx)(O.a,{fill:"var(--icon_tertiary)"})}),children:t.name},t.id)}))}),0===T.length&&Object(p.jsx)(i.g,{children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})]}),v]})]})};t.default=function(){var e=Object(i.C)().viewWidth,t=Object(i.D)(),r=e>=i.B.TABLET,o=t!==i.z,O=Object(n.useState)("favorites"),g=Object(c.a)(O,2),f=g[0],v=g[1],S=Object(n.useState)(null),y=Object(c.a)(S,2),m=y[0],w=y[1],C=Object(n.useState)("groups-list"),k=Object(c.a)(C,2),_=k[0],E=k[1],I=Object(n.useState)(""),L=Object(c.a)(I,2),J=L[0],N=L[1],F=Object(n.useState)(!1),P=Object(c.a)(F,2),V=P[0],T=P[1],A=Object(n.useState)(sessionStorage.getItem("groupsFavorite")?JSON.parse(sessionStorage.getItem("groupsFavorite")):[]),R=Object(c.a)(A,2),W=R[0],q=R[1];Object(n.useEffect)((function(){sessionStorage.setItem("groupsFavorite",JSON.stringify(W))}),[W]),Object(n.useEffect)((function(){history.pushState({activeStory:"favorites",searchValue:"",isSearch:!1,groups_activePanel:"groups-list",groups_contextOpened:!1},"")}),[]),Object(n.useEffect)((function(){return window.addEventListener("popstate",B),function(){window.removeEventListener("popstate",B)}}),[]);var H=function(e){history.pushState({activeStory:e.currentTarget.dataset.story,searchValue:"",isSearch:!1,groups_activePanel:"groups-list",groups_contextOpened:!1},""),v(e.currentTarget.dataset.story)},B=function(){history.state&&(w(null),T(history.state.groups_contextOpened),v(history.state.activeStory),E(history.state.groups_activePanel))},G=function(){if(V)document.body.style.overflow="visible",history.back();else{document.body.style.overflow="hidden";var e=history.state;e.groups_contextOpened=!0,history.pushState(e,""),T(!0)}};return Object(p.jsxs)(i.w,{header:o&&Object(p.jsx)(i.l,{separator:!1}),style:{justifyContent:"center"},children:[r&&Object(p.jsx)(i.v,{fixed:!0,width:280,maxWidth:280,children:Object(p.jsxs)(i.k,{children:[o&&Object(p.jsx)(i.l,{}),Object(p.jsxs)(i.h,{children:[Object(p.jsx)(i.c,{disabled:"favorites"===f,style:"favorites"===f?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"favorites",onClick:H,before:Object(p.jsx)(u.a,{}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(p.jsx)(i.c,{disabled:"groups"===f,style:"groups"===f?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"groups",onClick:H,before:Object(p.jsx)(j.a,{}),children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(p.jsx)(i.c,{disabled:"teachers"===f,style:"teachers"===f?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"teachers",onClick:H,before:Object(p.jsx)(d.a,{}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"})]})]})}),Object(p.jsx)(i.v,{animate:!r,spaced:r,width:r?"560px":"100%",maxWidth:r?"560px":"100%",children:Object(p.jsxs)(i.e,{activeStory:f,tabbar:!r&&Object(p.jsxs)(i.x,{children:[Object(p.jsx)(i.y,{onClick:H,selected:"favorites"===f,"data-story":"favorites",text:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435",children:Object(p.jsx)(u.a,{})}),Object(p.jsx)(i.y,{onClick:H,selected:"groups"===f,"data-story":"groups",text:"\u0413\u0440\u0443\u043f\u043f\u044b",children:Object(p.jsx)(j.a,{})}),Object(p.jsx)(i.y,{onClick:H,selected:"teachers"===f,"data-story":"teachers",text:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438",children:Object(p.jsx)(d.a,{})})]}),children:[Object(p.jsx)(i.A,{id:"favorites",activePanel:"favorites-list",children:Object(p.jsxs)(i.k,{id:"favorites-list",children:[Object(p.jsx)(i.l,{children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(p.jsx)(i.h,{style:{height:"1000px"},children:Object(p.jsx)(i.q,{icon:Object(p.jsx)(u.a,{width:56,height:56}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"})})]})}),Object(p.jsxs)(i.A,{id:"groups",activePanel:_,children:[Object(p.jsxs)(i.k,{id:"groups-list",children:[Object(p.jsx)(i.l,{children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(p.jsx)(x,{onGroupSelect:function(e){history.pushState({activeStory:"groups",searchValue:"",isSearch:!1,groups_activePanel:"group-schedule",groups_contextOpened:!1},""),q(sessionStorage.getItem("groupsFavorite")?JSON.parse(sessionStorage.getItem("groupsFavorite")):[]),N(e),E("group-schedule"),window.scrollTo(window.scrollX,0)}})]}),Object(p.jsxs)(i.k,{id:"group-schedule",children:[Object(p.jsx)(i.l,{left:Object(p.jsx)(i.m,{onClick:function(){return history.state.groups_contextOpened?history.go(-2):history.back()}}),children:Object(p.jsx)(i.n,{aside:Object(p.jsx)(b.a,{style:{transform:"rotate(".concat(V?"180deg":"0",")")}}),onClick:function(){return G()},children:J})}),Object(p.jsx)(i.o,{opened:V,onClose:function(){return G()},children:Object(p.jsx)(i.j,{children:Object(p.jsxs)(i.c,{before:Object(p.jsxs)(p.Fragment,{children:[W.includes(J)&&Object(p.jsx)(h.a,{fill:"var(--accent)"}),!W.includes(J)&&Object(p.jsx)(u.a,{fill:"var(--accent)"})]}),onClick:function(){return function(e){var t=Object(s.a)(W),r=null;W.includes(e)?(t.splice(W.indexOf(e),1),r=Object(p.jsx)(i.u,{onClose:function(){return w(null)},before:Object(p.jsx)(l.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u0437 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})):(t.push(e),r=Object(p.jsx)(i.u,{onClose:function(){return w(null)},before:Object(p.jsx)(l.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0432 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})),G(),a.a.send("VKWebAppStorageSet",{key:"groupsFavorite",value:JSON.stringify(t)}).then((function(){q(t)})).catch((function(){w(r)}))}(J)},children:[W.includes(J)&&'\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0437 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"',!W.includes(J)&&'\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"']})})}),Object(p.jsxs)(i.h,{style:{height:"1000px"},children:[Object(p.jsxs)(i.q,{icon:Object(p.jsx)(d.a,{width:56,height:56}),children:["\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0433\u0440\u0443\u043f\u043f\u044b ",J]}),m]})]})]}),Object(p.jsx)(i.A,{id:"teachers",activePanel:"teachers-list",children:Object(p.jsxs)(i.k,{id:"teachers-list",children:[Object(p.jsx)(i.l,{children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"}),Object(p.jsx)(i.h,{style:{height:"1000px"},children:Object(p.jsx)(i.q,{icon:Object(p.jsx)(d.a,{width:56,height:56}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0435\u0442\u043b\u0438"})})]})})]})})]})}}}]);
//# sourceMappingURL=5.c9ce0d70.chunk.js.map