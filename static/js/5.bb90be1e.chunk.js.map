{"version":3,"sources":["lists/groupsList.js","App.js"],"names":["GroupList","props","useState","AbortController","controller","history","state","searchValue","search","setSearch","snackbar","setSnackbar","localStorage","getItem","load","setLoad","fail","setFail","JSON","parse","groups","setGroups","filter","name","toLowerCase","indexOf","groupsSearchResult","setGroupsSearchResult","groups_CurrentPage","currentPage","setCurrentPage","endOfPage","setEndOfPage","fetching","setFetching","groupsRender","setGroupsRender","sessionStorage","groupsFavorite","setGroupsFavorite","useEffect","window","scrollTo","scrollX","storyState","replaceState","length","slice","setItem","stringify","axios","get","signal","then","response","console","log","data","catch","addEventListener","scrollHandler","removeEventListener","storsgeChangeHandler","abort","popstateHandler","e","detail","key","target","documentElement","scrollHeight","scrollTop","innerHeight","onRefresh","refreshErrorSnackbar","onClose","before","fill","width","height","duration","vertical","filled","readOnly","value","onChange","isSearch","activeStory","groups_activePanel","pushState","changeHandler","after","style","paddingTop","isFetching","minHeight","map","group","disabled","onClick","temp","favoriteChangeErrorSnackbar","includes","splice","push","bridge","send","favoritesFlagButtonClickHandler","id","onGroupSelect","App","viewWidth","useAdaptivity","platform","usePlatform","isDesktop","ViewWidth","TABLET","hasHeader","VKCOM","setActiveStory","groupsActivePanel","setGroupsActivePanel","groupName","setGroupName","onStoryChange","currentTarget","dataset","story","header","separator","justifyContent","fixed","maxWidth","backgroundColor","borderRadius","animate","spaced","tabbar","selected","text","activePanel","icon","left","back"],"mappings":"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","file":"static/js/5.bb90be1e.chunk.js","sourcesContent":["import { Icon16CancelCircleOutline, Icon28ChevronRightOutline, Icon28Favorite, Icon28FavoriteOutline } from \"@vkontakte/icons\"\r\nimport { Cell, FixedLayout, Footer, Group, IconButton, List, PanelSpinner, Placeholder, PullToRefresh, Search, Snackbar } from \"@vkontakte/vkui\"\r\nimport axios from \"axios\"\r\nimport { useEffect, useState } from \"react\"\r\nimport bridge from \"@vkontakte/vk-bridge\"\r\n\r\n\r\nfunction GroupList(props) {\r\n\r\n    const [controller] = useState(new AbortController())\r\n    const [search, setSearch] = useState(history.state.searchValue)\r\n    const [snackbar, setSnackbar] = useState(null)\r\n    const [load, setLoad] = useState(localStorage.getItem(\"groups\") ? true : false)\r\n    const [fail, setFail] = useState(false)\r\n    const [groups, setGroups] = useState(localStorage.getItem(\"groups\") ? JSON.parse(localStorage.getItem(\"groups\")) : [])\r\n    const [groupsSearchResult, setGroupsSearchResult] = useState(\r\n        localStorage.getItem(\"groups\")\r\n            ? \r\n                JSON.parse(localStorage.getItem(\"groups\")).filter(\r\n                    ({ name }) => name.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n                )\r\n            : \r\n                []\r\n    )\r\n    const [currentPage, setCurrentPage] = useState(history.state.groups_CurrentPage)\r\n    const [endOfPage, setEndOfPage] = useState(false)\r\n    const [fetching, setFetching] = useState(false)\r\n    const [groupsRender, setGroupsRender] = useState([])\r\n    const [groupsFavorite, setGroupsFavorite] = useState(sessionStorage.getItem(\"groupsFavorite\") ? JSON.parse(sessionStorage.getItem(\"groupsFavorite\")) : [])\r\n\r\n    useEffect(() => {\r\n        window.scrollTo(window.scrollX, 0)\r\n        let storyState = history.state\r\n        storyState.searchValue = search\r\n        history.replaceState(storyState, \"\")\r\n        setGroupsSearchResult(groups.filter(\r\n            ({ name }) => name.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n        ))\r\n    }, [search])\r\n\r\n    useEffect(() => {\r\n        if (endOfPage && groupsSearchResult.length > 30) {\r\n            setGroupsRender([...groupsRender, ...groupsSearchResult.slice(currentPage * 30, currentPage * 30 + 30)])\r\n            setCurrentPage(currentPage => currentPage + 1)\r\n            setEndOfPage(false)\r\n        } else {\r\n            setEndOfPage(false)\r\n        }\r\n    }, [endOfPage])\r\n\r\n    useEffect(() => {\r\n        setCurrentPage(1)\r\n        setGroupsRender(groupsSearchResult.slice(0, 30))\r\n    }, [groupsSearchResult])\r\n\r\n    useEffect(() => {\r\n        sessionStorage.setItem(\"groupsFavorite\", JSON.stringify(groupsFavorite))\r\n    }, [groupsFavorite])\r\n\r\n    useEffect(() => { \r\n        if (!load) {\r\n            axios\r\n                .get(\"https://journal.bsuir.by/api/v1/groups\", {\r\n                    signal: controller.signal\r\n                })\r\n                .then(response => {\r\n                    console.log(\"test\")\r\n                    localStorage.setItem(\"groups\", JSON.stringify(response.data))\r\n                    setGroups(response.data)\r\n                    setLoad(() => {\r\n                        setGroupsSearchResult(JSON.parse(localStorage.getItem(\"groups\")).filter(\r\n                            ({ name }) => name.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n                        ))\r\n                        return true\r\n                    })\r\n                })\r\n                .catch(() => {\r\n                    setFail(true)\r\n                })\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        window.addEventListener(\"scroll\", scrollHandler)\r\n        return function () {\r\n            window.removeEventListener(\"scroll\", scrollHandler)\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        window.addEventListener(\"storageChange\", storsgeChangeHandler)\r\n        return function () {\r\n            window.removeEventListener(\"storageChange\", storsgeChangeHandler)\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        return function () {\r\n            controller.abort()\r\n        }\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        window.addEventListener(\"popstate\", popstateHandler)\r\n        return function () {\r\n            window.removeEventListener(\"popstate\", popstateHandler)\r\n        }\r\n    }, [])\r\n\r\n    const storsgeChangeHandler = (e) => {\r\n        if (e.detail.key === \"groups\") {\r\n            setGroups(JSON.parse(localStorage.getItem(\"groups\")))\r\n            setGroupsSearchResult(JSON.parse(localStorage.getItem(\"groups\")).filter(\r\n                ({ name }) => name.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n            ))\r\n        }\r\n    }\r\n\r\n    const scrollHandler = (e) => {\r\n        if (e.target.documentElement.scrollHeight - (e.target.documentElement.scrollTop + window.innerHeight) < 100) {\r\n            setEndOfPage(true)\r\n        }\r\n    }\r\n\r\n    const favoritesFlagButtonClickHandler = (e) => {\r\n        const temp = [...groupsFavorite]\r\n        let favoriteChangeErrorSnackbar = null\r\n        if (groupsFavorite.includes(e)) {\r\n            temp.splice(groupsFavorite.indexOf(e), 1)\r\n            favoriteChangeErrorSnackbar = \r\n                <Snackbar\r\n                    onClose={() => setSnackbar(null)}\r\n                    before={<Icon16CancelCircleOutline fill=\"var(--dynamic_red)\" width={24} height={24} />}\r\n                    duration={1700}\r\n                >\r\n                    Не удалось удалить группу из \"Избранное\"\r\n                </Snackbar>\r\n        } else {\r\n            temp.push(e)\r\n            favoriteChangeErrorSnackbar =\r\n                <Snackbar\r\n                    onClose={() => setSnackbar(null)}\r\n                    before={<Icon16CancelCircleOutline fill=\"var(--dynamic_red)\" width={24} height={24} />}\r\n                    duration={1700}\r\n                >\r\n                    Не удалось добавить группу в \"Избранное\"\r\n                </Snackbar>\r\n        }\r\n        bridge\r\n            .send(\"VKWebAppStorageSet\", { \"key\": \"groupsFavorite\", \"value\": JSON.stringify(temp)})\r\n            .then(() => {\r\n                setGroupsFavorite(temp)\r\n            })\r\n            .catch(() => {\r\n                setSnackbar(favoriteChangeErrorSnackbar)\r\n            })\r\n    }\r\n\r\n    const onRefresh = () => {\r\n        setFetching(true)\r\n        axios\r\n            .get(\"https://journal.bsuir.by/api/v1/groups\", {\r\n                signal: controller.signal\r\n            })\r\n            .then(response => {\r\n                localStorage.setItem(\"groups\", JSON.stringify(response.data))\r\n                setGroups(response.data)\r\n                setFetching(() => {\r\n                    setGroupsSearchResult(JSON.parse(localStorage.getItem(\"groups\")).filter(\r\n                        ({ name }) => name.toLowerCase().indexOf(search.toLowerCase()) > -1\r\n                    ))\r\n                    return false\r\n                })\r\n                if (fail) {\r\n                    setLoad(true)\r\n                    setFail(false)\r\n                }\r\n            })\r\n            .catch(() => {\r\n                setFetching(false)\r\n                setSnackbar(refreshErrorSnackbar)\r\n            })\r\n    }\r\n\r\n    const openGroupScheduleHandler = (e) => {\r\n        props.onGroupSelect(e)\r\n    }\r\n\r\n    const changeHandler = (e) => {\r\n        if (history.state.isSearch) {\r\n            history.replaceState({\r\n                activeStory: \"groups\",\r\n                searchValue: e.target.value,\r\n                isSearch: true,\r\n                groups_activePanel: \"groups-list\"\r\n            }, \"\")\r\n        } else {\r\n            history.pushState({\r\n                activeStory: \"groups\",\r\n                searchValue: e.target.value,\r\n                isSearch: true,\r\n                groups_activePanel: \"groups-list\"\r\n            }, \"\")\r\n        }\r\n        setSearch(e.target.value)\r\n    }\r\n\r\n    const popstateHandler = () => {\r\n        if (history.state) {\r\n            setSearch(history.state.searchValue)\r\n        }\r\n    }\r\n\r\n    const refreshErrorSnackbar = \r\n        <Snackbar\r\n            onClose={() => setSnackbar(null)}\r\n            before={<Icon16CancelCircleOutline fill=\"var(--dynamic_red)\" width={24} height={24} />}\r\n            duration={1700}\r\n        >\r\n            Не удалось обновить список групп\r\n        </Snackbar>\r\n        \r\n\r\n    return (\r\n        <>\r\n            <FixedLayout vertical=\"top\" filled=\"true\">\r\n                <Search \r\n                    readOnly={!load || fetching}\r\n                    value={search}\r\n                    onChange={e => fetching ? () => {} : changeHandler(e) }\r\n                    after=\"Отмена\"\r\n                />\r\n            </FixedLayout>\r\n            <Group style={{ paddingTop: 40}}>\r\n                { !load && !fail && <PanelSpinner /> }\r\n                { fail && \r\n                    <PullToRefresh\r\n                        onRefresh={onRefresh}\r\n                        isFetching={fetching}\r\n                        style={{ minHeight: 350 }}\r\n                    >\r\n                        <Placeholder>Не удалось загрузить список групп</Placeholder>\r\n                    </PullToRefresh>\r\n                }\r\n                { load && !fail &&\r\n                    <PullToRefresh\r\n                        onRefresh={onRefresh}\r\n                        isFetching={fetching}\r\n                        style={{ minHeight: 350 }}\r\n                    >\r\n                        <List>\r\n                            { groupsSearchResult.length > 0 &&\r\n                                groupsRender.map((group) => (\r\n                                    <Cell\r\n                                        disabled={true}\r\n                                        key={group.id}\r\n                                        before={\r\n                                            <IconButton onClick={() => { favoritesFlagButtonClickHandler(group.id) }}>\r\n                                                {groupsFavorite.includes(group.id) && <Icon28Favorite fill=\"var(--accent)\" />}\r\n                                                {!groupsFavorite.includes(group.id) && <Icon28FavoriteOutline fill=\"var(--accent)\" />}\r\n                                            </IconButton>\r\n                                        }\r\n                                        after={\r\n                                            <IconButton onClick={() => { openGroupScheduleHandler(group.name) }}>\r\n                                                <Icon28ChevronRightOutline fill=\"var(--icon_tertiary)\" />\r\n                                            </IconButton>\r\n                                        }\r\n                                    >\r\n                                        {group.name}\r\n                                    </Cell>\r\n                                ))}\r\n                        </List>\r\n                        { groupsSearchResult.length === 0 && <Footer>Ничего не найдено</Footer> }\r\n                    </PullToRefresh>\r\n                }\r\n                {snackbar}\r\n            </Group>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default GroupList","import React, {useEffect, useState} from \"react\";\nimport {\n\tView,\n\tPanel,\n\tPanelHeader,\n\tGroup,\n\tuseAdaptivity,\n\tSplitCol,\n\tSplitLayout,\n\tViewWidth, \n\tusePlatform,\n\tVKCOM, \n\tCell,\n\tTabbar,\n\tTabbarItem,\n\tEpic,\n\tPlaceholder,\n\tPanelHeaderBack\n} from \"@vkontakte/vkui\";\nimport { Icon28EducationOutline, Icon28FavoriteOutline, Icon28UsersOutline } from \"@vkontakte/icons\";\nimport GroupList from \"./lists/groupsList\";\n\nconst App = () => {\n\tconst { viewWidth } = useAdaptivity()\n\tconst platform = usePlatform();\n\n\tconst isDesktop = viewWidth >= ViewWidth.TABLET;\n    const hasHeader = platform !== VKCOM;\n\n\tconst [activeStory, setActiveStory] = useState(\"favorites\");\n\tconst [groupsActivePanel, setGroupsActivePanel] = useState(\"groups-list\")\n\tconst [groupName, setGroupName] = useState(\"\")\n\n\tuseEffect(() => {\n\t\thistory.pushState({\n\t\t\tactiveStory: \"favorites\",\n\t\t\tsearchValue: \"\",\n\t\t\tisSearch: false,\n\t\t\tgroups_activePanel: \"groups-list\"\n\t\t}, \"\")\n\t}, [])\n\n\tuseEffect(() => {\n\t\twindow.addEventListener(\"popstate\", popstateHandler)\n\t\treturn function () {\n\t\t\twindow.removeEventListener(\"popstate\", popstateHandler)\n\t\t}\n\t}, [])\n\n\tconst onStoryChange = (e) => {\n\t\thistory.pushState({\n\t\t\tactiveStory: e.currentTarget.dataset.story,\n\t\t\tsearchValue: \"\",\n\t\t\tisSearch: false,\n\t\t\tgroups_activePanel: \"groups-list\"\n\t\t}, \"\")\n\t\tsetActiveStory(e.currentTarget.dataset.story)\n\t} \n\n\tconst popstateHandler = () => {\n\t\tif (history.state) {\n\t\t\tsetActiveStory(history.state.activeStory)\n\t\t\tsetGroupsActivePanel(history.state.groups_activePanel)\n\t\t}\n\t}\n\n\tconst groupSelecHandler = (e) => {\n\t\thistory.pushState({\n\t\t\tactiveStory: \"groups\",\n\t\t\tsearchValue: \"\",\n\t\t\tisSearch: false,\n\t\t\tgroups_activePanel: \"group-schedule\"\n\t\t}, \"\")\n\t\tsetGroupName(e)\n\t\tsetGroupsActivePanel(\"group-schedule\")\n\t\twindow.scrollTo(window.scrollX, 0)\n\t}\n\n\treturn (\n\t\t<SplitLayout\n\t\t\theader={hasHeader && <PanelHeader separator={false} />}\n\t\t\tstyle={{ justifyContent: \"center\" }}\n\t\t>\n\t\t\t{isDesktop && (\n\t\t\t\t<SplitCol fixed width={280} maxWidth={280}>\n\t\t\t\t\t<Panel>\n\t\t\t\t\t\t{hasHeader && <PanelHeader />}\n\t\t\t\t\t\t<Group>\n\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\tdisabled={activeStory === \"favorites\"}\n\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\tactiveStory === \"favorites\"\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"var(--button_secondary_background)\",\n\t\t\t\t\t\t\t\t\t\tborderRadius: 8,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata-story=\"favorites\"\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tbefore={<Icon28FavoriteOutline />}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tИзбранное\n\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\tdisabled={activeStory === \"groups\"}\n\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\tactiveStory === \"groups\"\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"var(--button_secondary_background)\",\n\t\t\t\t\t\t\t\t\t\tborderRadius: 8,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata-story=\"groups\"\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tbefore={<Icon28UsersOutline />}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tГруппы\n\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t\t<Cell\n\t\t\t\t\t\t\t\tdisabled={activeStory === \"teachers\"}\n\t\t\t\t\t\t\t\tstyle={\n\t\t\t\t\t\t\t\t\tactiveStory === \"teachers\"\n\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\tbackgroundColor: \"var(--button_secondary_background)\",\n\t\t\t\t\t\t\t\t\t\tborderRadius: 8,\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t: {}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdata-story=\"teachers\"\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tbefore={<Icon28EducationOutline />}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tПреподаватели\n\t\t\t\t\t\t\t</Cell>\n\t\t\t\t\t\t</Group>\n\t\t\t\t\t</Panel>\n\t\t\t\t</SplitCol>\n\t\t\t)}\n\t\t\t<SplitCol\n\t\t\t\tanimate={!isDesktop}\n\t\t\t\tspaced={isDesktop}\n\t\t\t\twidth={isDesktop ? \"560px\" : \"100%\"}\n\t\t\t\tmaxWidth={isDesktop ? \"560px\" : \"100%\"}\n        \t>\n\t\t\t\t<Epic\n\t\t\t\t\tactiveStory={activeStory}\n\t\t\t\t\ttabbar={\n\t\t\t\t\t!isDesktop && (\n\t\t\t\t\t\t<Tabbar>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tselected={activeStory === \"favorites\"}\n\t\t\t\t\t\t\t\tdata-story=\"favorites\"\n\t\t\t\t\t\t\t\ttext=\"Избранное\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28FavoriteOutline />\n\t\t\t\t\t\t\t</TabbarItem>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tselected={activeStory === \"groups\"}\n\t\t\t\t\t\t\t\tdata-story=\"groups\"\n\t\t\t\t\t\t\t\ttext=\"Группы\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28UsersOutline />\n\t\t\t\t\t\t\t</TabbarItem>\n\t\t\t\t\t\t\t<TabbarItem\n\t\t\t\t\t\t\t\tonClick={onStoryChange}\n\t\t\t\t\t\t\t\tselected={activeStory === \"teachers\"}\n\t\t\t\t\t\t\t\tdata-story=\"teachers\"\n\t\t\t\t\t\t\t\ttext=\"Преподаватели\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Icon28EducationOutline />\n\t\t\t\t\t\t\t</TabbarItem>\n\t\t\t\t\t\t</Tabbar>\n\t\t\t\t\t)}\n\t\t\t\t>\t\n\t\t\t\t\t<View id=\"favorites\" activePanel=\"favorites-list\">\n\t\t\t\t\t\t<Panel id=\"favorites-list\">\n\t\t\t\t\t\t\t<PanelHeader>Избранное</PanelHeader>\n\t\t\t\t\t\t\t<Group style={{ height: \"1000px\" }}>\n\t\t\t\t\t\t\t\t<Placeholder\n\t\t\t\t\t\t\t\t\ticon={ <Icon28FavoriteOutline width={56} height={56} /> }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tИзбранное\n\t\t\t\t\t\t\t\t</Placeholder>\n\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\t\t\t\t\t<View id=\"groups\" activePanel={groupsActivePanel}>\n\t\t\t\t\t\t<Panel id=\"groups-list\">\n\t\t\t\t\t\t\t<PanelHeader>Группы</PanelHeader>\n\t\t\t\t\t\t\t<GroupList onGroupSelect={groupSelecHandler} />\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t\t<Panel id=\"group-schedule\">\n\t\t\t\t\t\t\t<PanelHeader\n\t\t\t\t\t\t\t\tleft={\n\t\t\t\t\t\t\t\t\t<PanelHeaderBack\n\t\t\t\t\t\t\t\t\t\tonClick={ () => history.back() }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{groupName}\n\t\t\t\t\t\t\t</PanelHeader>\n\t\t\t\t\t\t\t<Group style={{ height: \"1000px\"}}>\n\t\t\t\t\t\t\t\t<Placeholder\n\t\t\t\t\t\t\t\t\ticon={<Icon28EducationOutline width={56} height={56} />}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tРасписание группы {groupName}\n\t\t\t\t\t\t\t\t</Placeholder>\n\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\t\t\t\t\t<View id=\"teachers\" activePanel=\"teachers-list\">\n\t\t\t\t\t\t<Panel id=\"teachers-list\">\n\t\t\t\t\t\t\t<PanelHeader>Преподаватели</PanelHeader>\n\t\t\t\t\t\t\t<Group style={{ height: \"1000px\" }}>\n\t\t\t\t\t\t\t\t<Placeholder\n\t\t\t\t\t\t\t\t\ticon={<Icon28EducationOutline width={56} height={56} />}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tПреподаваетли\n\t\t\t\t\t\t\t\t</Placeholder>\n\t\t\t\t\t\t\t</Group>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t</View>\n\t\t\t\t</Epic>\n        \t</SplitCol>\n\t\t</SplitLayout>\n\t);\n};\n\nexport default App\n\n\n"],"sourceRoot":""}