(this.webpackJsonpsrc=this.webpackJsonpsrc||[]).push([[5],{174:function(e,t,r){"use strict";r.r(t);var c=r(144),s=r(0),n=r(11),a=r(170),i=r(171),o=r(172),l=r(167),j=r(168),u=r(169),d=r(145),b=r.n(d),O=r(13),h=r.n(O),f=r(9);var g=function(){var e=Object(s.useState)(new AbortController),t=Object(c.a)(e,1)[0],r=Object(s.useState)(history.state.searchValue),i=Object(c.a)(r,2),o=i[0],d=i[1],O=Object(s.useState)(null),g=Object(c.a)(O,2),x=g[0],p=g[1],v=Object(s.useState)(!!localStorage.getItem("groups")),S=Object(c.a)(v,2),y=S[0],w=S[1],m=Object(s.useState)(!1),C=Object(c.a)(m,2),k=C[0],E=C[1],L=Object(s.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")):[]),I=Object(c.a)(L,2),J=I[0],N=I[1],_=Object(s.useState)(localStorage.getItem("groups")?JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(o.toLowerCase())>-1})):[]),F=Object(c.a)(_,2),T=F[0],R=F[1],V=Object(s.useState)(1),A=Object(c.a)(V,2),H=A[0],W=A[1],P=Object(s.useState)(!1),q=Object(c.a)(P,2),z=q[0],B=q[1],K=Object(s.useState)(!1),X=Object(c.a)(K,2),D=X[0],G=X[1],M=Object(s.useState)([]),Q=Object(c.a)(M,2),U=Q[0],Y=Q[1],Z=Object(s.useState)(sessionStorage.getItem("groupsFavorite")?JSON.parse(sessionStorage.getItem("groupsFavorite")):[]),$=Object(c.a)(Z,2),ee=$[0],te=$[1];Object(s.useEffect)((function(){window.scrollTo(window.scrollX,0);var e=history.state;e.searchValue=o,history.replaceState(e,""),R(J.filter((function(e){return e.name.toLowerCase().indexOf(o.toLowerCase())>-1})))}),[o]),Object(s.useEffect)((function(){z&&(Y([].concat(Object(l.a)(U),Object(l.a)(T.slice(30*H,30*H+30)))),W((function(e){return e+1})),B(!1))}),[z]),Object(s.useEffect)((function(){W(1),Y(T.slice(0,30))}),[T]),Object(s.useEffect)((function(){sessionStorage.setItem("groupsFavorite",JSON.stringify(ee))}),[ee]),Object(s.useEffect)((function(){y||b.a.get("https://journal.bsuir.by/api/v1/groups",{signal:t.signal}).then((function(e){console.log("test"),localStorage.setItem("groups",JSON.stringify(e.data)),N(e.data),w((function(){return R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(o.toLowerCase())>-1}))),!0}))})).catch((function(){E(!0)}))}),[]),Object(s.useEffect)((function(){return window.addEventListener("scroll",ce),function(){window.removeEventListener("scroll",ce)}}),[]),Object(s.useEffect)((function(){return window.addEventListener("storageChange",re),function(){window.removeEventListener("storageChange",re)}}),[]),Object(s.useEffect)((function(){return function(){t.abort()}}),[]);var re=function(e){"groups"===e.detail.key&&(N(JSON.parse(localStorage.getItem("groups"))),R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(o.toLowerCase())>-1}))))},ce=function(e){e.target.documentElement.scrollHeight-(e.target.documentElement.scrollTop+window.innerHeight)<100&&B(!0)},se=function(){G(!0),b.a.get("https://journal.bsuir.by/api/v1/groups",{signal:t.signal}).then((function(e){localStorage.setItem("groups",JSON.stringify(e.data)),N(e.data),G((function(){return R(JSON.parse(localStorage.getItem("groups")).filter((function(e){return e.name.toLowerCase().indexOf(o.toLowerCase())>-1}))),!1})),k&&(w(!0),E(!1))})).catch((function(){G(!1),p(ne)}))},ne=Object(f.jsx)(n.r,{onClose:function(){return p(null)},before:Object(f.jsx)(j.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"});return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(n.f,{vertical:"top",filled:"true",children:Object(f.jsx)(n.q,{readOnly:!y||D,value:o,onChange:function(e){return D?o:d(e.target.value)},after:"\u041e\u0442\u043c\u0435\u043d\u0430"})}),Object(f.jsxs)(n.h,{style:{paddingTop:40},children:[!y&&!k&&Object(f.jsx)(n.m,{}),k&&Object(f.jsx)(n.o,{onRefresh:se,isFetching:D,style:{minHeight:"350px"},children:Object(f.jsx)(n.n,{children:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u0433\u0440\u0443\u043f\u043f"})}),y&&!k&&Object(f.jsxs)(n.o,{onRefresh:se,isFetching:D,style:{minHeight:"350px"},children:[Object(f.jsx)(n.j,{children:T.length>0&&U.map((function(e){return Object(f.jsx)(n.c,{after:Object(f.jsxs)(n.i,{onClick:function(){!function(e){var t=Object(l.a)(ee),r=null;ee.includes(e)?(t.splice(ee.indexOf(e),1),r=Object(f.jsx)(n.r,{onClose:function(){return p(null)},before:Object(f.jsx)(j.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0438\u0437 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})):(t.push(e),r=Object(f.jsx)(n.r,{onClose:function(){return p(null)},before:Object(f.jsx)(j.a,{fill:"var(--dynamic_red)",width:24,height:24}),duration:1700,children:'\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0433\u0440\u0443\u043f\u043f\u0443 \u0432 "\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"'})),h.a.send("VKWebAppStorageSet",{key:"groupsFavorite",value:JSON.stringify(t)}).then((function(){te(t)})).catch((function(){p(r)}))}(e.id)},children:[ee.includes(e.id)&&Object(f.jsx)(u.a,{}),!ee.includes(e.id)&&Object(f.jsx)(a.a,{})]}),children:e.name},e.id)}))}),0===T.length&&Object(f.jsx)(n.g,{children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"})]}),x]})]})};t.default=function(){var e=Object(n.z)().viewWidth,t=Object(n.A)(),r=e>=n.y.TABLET,l=t!==n.w,j=Object(s.useState)("favorites"),u=Object(c.a)(j,2),d=u[0],b=u[1];Object(s.useEffect)((function(){history.pushState({title:"navigation",activeStory:"favorites",searchValue:""},"")}),[]),Object(s.useEffect)((function(){return window.addEventListener("popstate",h),function(){window.removeEventListener("popstate",h)}}),[]);var O=function(e){history.pushState({title:"navigation",activeStory:e.currentTarget.dataset.story,searchValue:""},""),b(e.currentTarget.dataset.story)},h=function(){history.state&&"navigation"===history.state.title&&b(history.state.activeStory)};return Object(f.jsxs)(n.t,{header:l&&Object(f.jsx)(n.l,{separator:!1}),style:{justifyContent:"center"},children:[r&&Object(f.jsx)(n.s,{fixed:!0,width:280,maxWidth:280,children:Object(f.jsxs)(n.k,{children:[l&&Object(f.jsx)(n.l,{}),Object(f.jsxs)(n.h,{children:[Object(f.jsx)(n.c,{disabled:"favorites"===d,style:"favorites"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"favorites",onClick:O,before:Object(f.jsx)(a.a,{}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(f.jsx)(n.c,{disabled:"groups"===d,style:"groups"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"groups",onClick:O,before:Object(f.jsx)(i.a,{}),children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(f.jsx)(n.c,{disabled:"teachers"===d,style:"teachers"===d?{backgroundColor:"var(--button_secondary_background)",borderRadius:8}:{},"data-story":"teachers",onClick:O,before:Object(f.jsx)(o.a,{}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"})]})]})}),Object(f.jsx)(n.s,{animate:!r,spaced:r,width:r?"560px":"100%",maxWidth:r?"560px":"100%",children:Object(f.jsxs)(n.e,{activeStory:d,tabbar:!r&&Object(f.jsxs)(n.u,{children:[Object(f.jsx)(n.v,{onClick:O,selected:"favorites"===d,"data-story":"favorites",text:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435",children:Object(f.jsx)(a.a,{})}),Object(f.jsx)(n.v,{onClick:O,selected:"groups"===d,"data-story":"groups",text:"\u0413\u0440\u0443\u043f\u043f\u044b",children:Object(f.jsx)(i.a,{})}),Object(f.jsx)(n.v,{onClick:O,selected:"teachers"===d,"data-story":"teachers",text:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438",children:Object(f.jsx)(o.a,{})})]}),children:[Object(f.jsx)(n.x,{id:"favorites",activePanel:"favorites-list",children:Object(f.jsxs)(n.k,{id:"favorites-list",children:[Object(f.jsx)(n.l,{children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"}),Object(f.jsx)(n.h,{style:{height:"1000px"},children:Object(f.jsx)(n.n,{icon:Object(f.jsx)(a.a,{width:56,height:56}),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"})})]})}),Object(f.jsx)(n.x,{id:"groups",activePanel:"groups-list",children:Object(f.jsxs)(n.k,{id:"groups-list",children:[Object(f.jsx)(n.l,{children:"\u0413\u0440\u0443\u043f\u043f\u044b"}),Object(f.jsx)(g,{})]})}),Object(f.jsx)(n.x,{id:"teachers",activePanel:"teachers-list",children:Object(f.jsxs)(n.k,{id:"teachers-list",children:[Object(f.jsx)(n.l,{children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0442\u0435\u043b\u0438"}),Object(f.jsx)(n.h,{style:{height:"1000px"},children:Object(f.jsx)(n.n,{icon:Object(f.jsx)(o.a,{width:56,height:56}),children:"\u041f\u0440\u0435\u043f\u043e\u0434\u0430\u0432\u0430\u0435\u0442\u043b\u0438"})})]})})]})})]})}}}]);
//# sourceMappingURL=5.4106d0f1.chunk.js.map